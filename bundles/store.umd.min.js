!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("rxjs/BehaviorSubject"),require("rxjs/Observable"),require("rxjs/Subject"),require("rxjs/scheduler/queue"),require("rxjs/operator/observeOn"),require("rxjs/operator/withLatestFrom"),require("rxjs/operator/scan"),require("rxjs/operator/map"),require("rxjs/operator/pluck"),require("rxjs/operator/distinctUntilChanged")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/BehaviorSubject","rxjs/Observable","rxjs/Subject","rxjs/scheduler/queue","rxjs/operator/observeOn","rxjs/operator/withLatestFrom","rxjs/operator/scan","rxjs/operator/map","rxjs/operator/pluck","rxjs/operator/distinctUntilChanged"],factory):factory((global.ngrx=global.ngrx||{},global.ngrx.store=global.ngrx.store||{}),global.ng.core,global.Rx,global.Rx,global.Rx,global.Rx.Scheduler,global.Rx.Observable.prototype,global.Rx.Observable,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype)}(this,function(exports,_angular_core,rxjs_BehaviorSubject,rxjs_Observable,rxjs_Subject,rxjs_scheduler_queue,rxjs_operator_observeOn,rxjs_operator_withLatestFrom,rxjs_operator_scan,rxjs_operator_map,rxjs_operator_pluck,rxjs_operator_distinctUntilChanged){"use strict";function combineReducers(reducers,initialState){void 0===initialState&&(initialState={});for(var reducerKeys=Object.keys(reducers),finalReducers={},i=0;i<reducerKeys.length;i++){var key=reducerKeys[i];"function"==typeof reducers[key]&&(finalReducers[key]=reducers[key])}var finalReducerKeys=Object.keys(finalReducers);return function(state,action){void 0===state&&(state=initialState);for(var hasChanged=!1,nextState={},i=0;i<finalReducerKeys.length;i++){var key=finalReducerKeys[i],reducer=finalReducers[key],previousStateForKey=state[key],nextStateForKey=reducer(previousStateForKey,action);nextState[key]=nextStateForKey,hasChanged=hasChanged||nextStateForKey!==previousStateForKey}return hasChanged?nextState:state}}function omit(object,keyToRemove){return Object.keys(object).filter(function(key){return key!==keyToRemove}).reduce(function(result,key){return result[key]=object[key]},{})}function compose(){for(var functions=[],_i=0;_i<arguments.length;_i++)functions[_i]=arguments[_i];return function(arg){if(0===functions.length)return arg;var last=functions[functions.length-1];return functions.slice(0,-1).reduceRight(function(composed,fn){return fn(composed)},last(arg))}}function reduceState(_a,_b){var state=(void 0===_a?{state:void 0}:_a).state,action=_b[0];return{state:(0,_b[1])(state,action),action:action}}function memoize(t){function reset(){lastArguments=null,lastResult=null}function memoized(){if(!lastArguments)return lastResult=t.apply(null,arguments),lastArguments=arguments,lastResult;for(var i=0;i<arguments.length;i++)if(arguments[i]!==lastArguments[i])return lastResult=t.apply(null,arguments),lastArguments=arguments,lastResult;return lastResult}var lastArguments=null,lastResult=null;return{memoized:memoized,reset:reset}}function createSelector(){function release(){reset(),memoizedSelectors.forEach(function(selector){return selector.release()})}for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var selectors=args.slice(0,args.length-1),projector=args[args.length-1],memoizedSelectors=selectors.filter(function(selector){return selector.release&&"function"==typeof selector.release}),_a=memoize(function(state){var args=selectors.map(function(fn){return fn(state)});return projector.apply(null,args)}),memoized=_a.memoized,reset=_a.reset;return Object.assign(memoized,{release:release})}function createFeatureSelector(featureName){var _a=memoize(function(state){return state[featureName]}),memoized=_a.memoized,reset=_a.reset;return Object.assign(memoized,{release:reset})}var __extends=function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),INITIAL_STATE=new _angular_core.OpaqueToken("@ngrx/store Initial State"),REDUCER_FACTORY=new _angular_core.OpaqueToken("@ngrx/store Reducer Factory"),INITIAL_REDUCERS=new _angular_core.OpaqueToken("@ngrx/store Initial Reducers"),STORE_FEATURES=new _angular_core.OpaqueToken("@ngrx/store Store Features"),INIT="@ngrx/store/init",ActionsSubject=function(_super){function ActionsSubject(){return _super.call(this,{type:INIT})||this}return __extends(ActionsSubject,_super),ActionsSubject.prototype.next=function(action){if(void 0===action)throw new Error("Actions must be objects");if(void 0===action.type)throw new Error("Actions must have a type property");_super.prototype.next.call(this,action)},ActionsSubject.prototype.complete=function(){},ActionsSubject.prototype.ngOnDestroy=function(){_super.prototype.complete.call(this)},ActionsSubject}(rxjs_BehaviorSubject.BehaviorSubject);ActionsSubject.decorators=[{type:_angular_core.Injectable}],ActionsSubject.ctorParameters=function(){return[]};var ACTIONS_SUBJECT_PROVIDERS=[ActionsSubject],ReducerObservable=function(_super){function ReducerObservable(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ReducerObservable,_super),ReducerObservable}(rxjs_Observable.Observable),ReducerManagerDispatcher=function(_super){function ReducerManagerDispatcher(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ReducerManagerDispatcher,_super),ReducerManagerDispatcher}(ActionsSubject),UPDATE="@ngrx/store/update-reducers",ReducerManager=function(_super){function ReducerManager(dispatcher,initialState,reducers,reducerFactory){var _this=_super.call(this,reducerFactory(reducers,initialState))||this;return _this.dispatcher=dispatcher,_this.initialState=initialState,_this.reducers=reducers,_this.reducerFactory=reducerFactory,_this}return __extends(ReducerManager,_super),ReducerManager.prototype.addFeature=function(_a){var reducers=_a.reducers,reducerFactory=_a.reducerFactory,initialState=_a.initialState,key=_a.key,reducer=reducerFactory(reducers,initialState);this.addReducer(key,reducer)},ReducerManager.prototype.removeFeature=function(_a){var key=_a.key;this.removeReducer(key)},ReducerManager.prototype.addReducer=function(key,reducer){this.reducers=Object.assign({},this.reducers,(_a={},_a[key]=reducer,_a)),this.updateReducers();var _a},ReducerManager.prototype.removeReducer=function(key){this.reducers=omit(this.reducers,key),this.updateReducers()},ReducerManager.prototype.updateReducers=function(){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:UPDATE})},ReducerManager.prototype.ngOnDestroy=function(){this.complete()},ReducerManager}(rxjs_BehaviorSubject.BehaviorSubject);ReducerManager.decorators=[{type:_angular_core.Injectable}],ReducerManager.ctorParameters=function(){return[{type:ReducerManagerDispatcher},{type:void 0,decorators:[{type:_angular_core.Inject,args:[INITIAL_STATE]}]},{type:void 0,decorators:[{type:_angular_core.Inject,args:[INITIAL_REDUCERS]}]},{type:void 0,decorators:[{type:_angular_core.Inject,args:[REDUCER_FACTORY]}]}]};var REDUCER_MANAGER_PROVIDERS=[ReducerManager,{provide:ReducerObservable,useExisting:ReducerManager},{provide:ReducerManagerDispatcher,useExisting:ActionsSubject}],ScannedActionsSubject=function(_super){function ScannedActionsSubject(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ScannedActionsSubject,_super),ScannedActionsSubject.prototype.ngOnDestroy=function(){this.complete()},ScannedActionsSubject}(rxjs_Subject.Subject);ScannedActionsSubject.decorators=[{type:_angular_core.Injectable}],ScannedActionsSubject.ctorParameters=function(){return[]};var SCANNED_ACTIONS_SUBJECT_PROVIDERS=[ScannedActionsSubject],StateObservable=function(_super){function StateObservable(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(StateObservable,_super),StateObservable}(rxjs_Observable.Observable),State=function(_super){function State(actions$,reducer$,scannedActions,initialState){var _this=_super.call(this,initialState)||this,actionsOnQueue$=rxjs_operator_observeOn.observeOn.call(actions$,rxjs_scheduler_queue.queue),withLatestReducer$=rxjs_operator_withLatestFrom.withLatestFrom.call(actionsOnQueue$,reducer$),stateAndAction$=rxjs_operator_scan.scan.call(withLatestReducer$,reduceState,initialState);return _this.stateSubscription=stateAndAction$.subscribe({next:function(_a){var state=_a.state,action=_a.action;_this.next(state),scannedActions.next(action)}}),_this}return __extends(State,_super),State.prototype.ngOnDestroy=function(){this.stateSubscription.unsubscribe(),this.complete()},State}(rxjs_BehaviorSubject.BehaviorSubject);State.INIT="@ngrx/store/init",State.decorators=[{type:_angular_core.Injectable}],State.ctorParameters=function(){return[{type:ActionsSubject},{type:ReducerObservable},{type:ScannedActionsSubject},{type:void 0,decorators:[{type:_angular_core.Inject,args:[INITIAL_STATE]}]}]};var STATE_PROVIDERS=[State,{provide:StateObservable,useExisting:State}],Store=function(_super){function Store(state$,actionsObserver,reducerManager){var _this=_super.call(this)||this;return _this.actionsObserver=actionsObserver,_this.reducerManager=reducerManager,_this.source=state$,_this}return __extends(Store,_super),Store.prototype.select=function(pathOrMapFn){for(var paths=[],_i=1;_i<arguments.length;_i++)paths[_i-1]=arguments[_i];var mapped$;if("string"==typeof pathOrMapFn)mapped$=rxjs_operator_pluck.pluck.call.apply(rxjs_operator_pluck.pluck,[this,pathOrMapFn].concat(paths));else{if("function"!=typeof pathOrMapFn)throw new TypeError("Unexpected type '"+typeof pathOrMapFn+"' in select operator, expected 'string' or 'function'");mapped$=rxjs_operator_map.map.call(this,pathOrMapFn)}return rxjs_operator_distinctUntilChanged.distinctUntilChanged.call(mapped$)},Store.prototype.lift=function(operator){var store=new Store(this,this.actionsObserver,this.reducerManager);return store.operator=operator,store},Store.prototype.dispatch=function(action){this.actionsObserver.next(action)},Store.prototype.next=function(action){this.actionsObserver.next(action)},Store.prototype.error=function(err){this.actionsObserver.error(err)},Store.prototype.complete=function(){this.actionsObserver.complete()},Store.prototype.addReducer=function(key,reducer){this.reducerManager.addReducer(key,reducer)},Store.prototype.removeReducer=function(key){this.reducerManager.removeReducer(key)},Store}(rxjs_Observable.Observable);Store.decorators=[{type:_angular_core.Injectable}],Store.ctorParameters=function(){return[{type:StateObservable},{type:ActionsSubject},{type:ReducerManager}]};var STORE_PROVIDERS=[Store],StoreRootModule=function(){function StoreRootModule(){}return StoreRootModule}();StoreRootModule.decorators=[{type:_angular_core.NgModule,args:[{}]}],StoreRootModule.ctorParameters=function(){return[]};var StoreFeatureModule=function(){function StoreFeatureModule(features,reducerManager){this.features=features,this.reducerManager=reducerManager,features.forEach(function(feature){return reducerManager.addFeature(feature)})}return StoreFeatureModule.prototype.ngOnDestroy=function(){var _this=this;this.features.forEach(function(feature){return _this.reducerManager.removeFeature(feature)})},StoreFeatureModule}();StoreFeatureModule.decorators=[{type:_angular_core.NgModule,args:[{}]}],StoreFeatureModule.ctorParameters=function(){return[{type:Array,decorators:[{type:_angular_core.Inject,args:[STORE_FEATURES]}]},{type:ReducerManager}]};var StoreModule=function(){function StoreModule(){}return StoreModule.forRoot=function(reducers,config){return void 0===config&&(config={}),{ngModule:StoreRootModule,providers:[{provide:INITIAL_STATE,useValue:config.initialState},{provide:INITIAL_REDUCERS,useValue:reducers},{provide:REDUCER_FACTORY,useValue:config.reducerFactory?config.reducerFactory:combineReducers},ACTIONS_SUBJECT_PROVIDERS,REDUCER_MANAGER_PROVIDERS,SCANNED_ACTIONS_SUBJECT_PROVIDERS,STATE_PROVIDERS,STORE_PROVIDERS]}},StoreModule.forFeature=function(featureName,reducers,config){return void 0===config&&(config={}),{ngModule:StoreFeatureModule,providers:[{provide:STORE_FEATURES,multi:!0,useValue:{key:featureName,reducers:reducers,reducerFactory:config.reducerFactory?config.reducerFactory:combineReducers,initialState:config.initialState}}]}},StoreModule}();StoreModule.decorators=[{type:_angular_core.NgModule,args:[{}]}],StoreModule.ctorParameters=function(){return[]},exports.StoreModule=StoreModule,exports.Store=Store,exports.combineReducers=combineReducers,exports.compose=compose,exports.ActionsSubject=ActionsSubject,exports.INIT=INIT,exports.ReducerManager=ReducerManager,exports.ReducerObservable=ReducerObservable,exports.ReducerManagerDispatcher=ReducerManagerDispatcher,exports.UPDATE=UPDATE,exports.ScannedActionsSubject=ScannedActionsSubject,exports.createSelector=createSelector,exports.createFeatureSelector=createFeatureSelector,exports.State=State,exports.StateObservable=StateObservable,exports.reduceState=reduceState,exports.INITIAL_STATE=INITIAL_STATE,exports.REDUCER_FACTORY=REDUCER_FACTORY,exports.INITIAL_REDUCERS=INITIAL_REDUCERS,exports.STORE_FEATURES=STORE_FEATURES,exports.StoreRootModule=StoreRootModule,exports.StoreFeatureModule=StoreFeatureModule,exports.ɵc=ACTIONS_SUBJECT_PROVIDERS,exports.ɵd=REDUCER_MANAGER_PROVIDERS,exports.ɵe=SCANNED_ACTIONS_SUBJECT_PROVIDERS,exports.ɵf=STATE_PROVIDERS,exports.ɵb=STORE_PROVIDERS,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=./dist/store/bundles/store.umd.min.js.map